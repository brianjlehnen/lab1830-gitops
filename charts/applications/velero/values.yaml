# Velero application chart values
image:
  repository: velero/velero
  tag: "v1.12.1"
  pullPolicy: IfNotPresent

# Service configuration
service:
  type: ClusterIP
  port: 8085

# Velero configuration
velero:
  configuration:
    backupStorageLocation:
      - name: nfs-backup
        provider: aws
        bucket: velero-backups
        config:
          region: homelab
          s3ForcePathStyle: "true"
          s3Url: "http://nfs-gateway.velero.svc.cluster.local:9000"
          publicUrl: "http://nfs-gateway.velero.svc.cluster.local:9000"
    
    volumeSnapshotLocation:
      - name: restic
        provider: restic

  # Enable node agent for Restic
  deployNodeAgent: true
  
  # Backup schedules
  schedules:
    daily-cluster:
      disabled: false
      schedule: "0 1 * * *"  # 1 AM daily
      useOwnerReferencesInBackup: false
      template:
        includedNamespaces: ["*"]
        excludedNamespaces: ["velero"]
        defaultVolumesToFsBackup: true
        storageLocation: nfs-backup
        ttl: "168h"  # 7 days retention

# Resources
resources:
  requests:
    cpu: 50m
    memory: 128Mi
  limits:
    cpu: 200m
    memory: 512Mi

# NFS Gateway (MinIO S3-compatible interface)
nfsGateway:
  enabled: true
  image:
    repository: minio/minio
    tag: latest
    pullPolicy: IfNotPresent
  
  credentials:
    accessKey: "velero"
    secretKey: "velero123"
  
  nfs:
    server: "192.168.4.159"
    path: "/volume1/Backups/velero"
  
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

# Node selector and tolerations
nodeSelector: {}
tolerations: []
affinity: {}